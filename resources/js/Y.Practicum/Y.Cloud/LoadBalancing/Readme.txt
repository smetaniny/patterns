Развёртывание копий сайта на нескольких ВМ помогает сделать сайт устойчивым к наплыву посетителей.
Сетевая балансировка распределяет нагрузку между ВМ, каждая из которых получает 20% запросов.
Балансировщик принимает запросы от пользователей, распределяет их по ВМ и передаёт ответы пользователям.
Абстрактность имён позволяет сервису, передающему трафик, не знать адреса и названия ВМ.
Балансировка защищает веб-приложение от выхода ВМ из строя и позволяет обновлять код сайта или веб-приложения.
Размещение ВМ в разных зонах доступности обеспечивает максимальную доступность сайта или приложения.

Настройка сетевой балансировки в Yandex Network Load Balancer требует создания целевой группы и обработчика.
Целевая группа представляет собой список внутренних IP-адресов и подсетей, по которым распределяются запросы пользователей.
Обработчик принимает соединения от пользователей, распределяет их между IP-адресами целевой группы и передаёт обратный трафик клиентам.
Адресация трафика строится по принципу 5-tuple, учитывая адрес и порт отправителя, адрес и порт целевого ресурса, а также протокол передачи информации.
При создании сетевого балансировщика необязательно настраивать обработчик сразу, его можно добавить позднее.
Целевую группу можно подключить к нескольким балансировщикам, используя разные целевые порты.
После подключения целевой группы балансировщик начнёт проверять состояние целевых ресурсов и сможет распределять нагрузку между ними.

Создан сетевой балансировщик с обработчиками и целевой группой из пяти ВМ.
Одна ВМ вышла из строя, требуется проверка доступности ресурсов.
Балансировщик запрашивает у каждой ВМ страницу по HTTP раз в 10 секунд.
Ресурс считается доступным, если он отвечает кодом 200 за установленное время ожидания.
Ресурс считается недоступным, если он не отвечает кодом 200 или число последовательных неудачных проверок превышает порог неработоспособности.
Работа проблемной ВМ будет восстановлена, если она снова начнёт отдавать код 200.

Создавайте ресурсы в разных зонах доступности для высокой отказоустойчивости.
Размещайте одинаковое количество облачных ресурсов в каждой зоне доступности.
Создавайте облачные ресурсы с запасом для предотвращения выхода из строя ВМ.
Используйте разные балансировщики для разных приложений для эффективного управления нагрузкой.
Организуйте двухуровневую архитектуру с балансировщиками на четвертом и седьмом уровнях OSI.
Используйте балансировщики седьмого уровня, такие как веб-сервер NGINX, для более сложной работы с IP-пакетами.
Перенаправляйте трафик на работающие ВМ при сбое виртуальных машин.
